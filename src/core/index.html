<!DOCTYPE html>
    <html lang="en">
    <head>
        <script type="module">
            import {
                step,
                loadROM,
                getRAM,
                getScreen,
            } from "./build/release.js"
            window.getScreen = getScreen;
            loadROM();

            const offscreen = document.querySelector('canvas').transferControlToOffscreen();
            const screen = new Worker('screen.js');
            screen.postMessage(offscreen, [offscreen]);

            function computer() {
                let now = performance.now();
                while (performance.now() - now < 50) {
                    step();
                }
                screen.postMessage(getScreen());
                setTimeout(computer, 0);
            }
            computer();

        </script>
        <style>
            body {
                background-color: tan;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            canvas {
                image-rendering: pixelated;
                image-rendering: crisp-edges;
                border: 2px solid black;
                background: white;
            }
        </style>
    </head>
    <body>
        <canvas width="512" height="256"></canvas>
    </body>
</html>
