import assert from "assert"
import { CPU, tick, tock } from "../build/debug.js";
export function TestCPU() {
    function listEqual(a, b) {
        assert.strictEqual(a.length, b.length);
        for (let i = 0; i < a.length; i++) {
            if (b[i] === -1)
                continue
            assert.strictEqual(a[i], b[i]);
        }
    }

    tick()
    listEqual(CPU(0, 12345, 0), [0, 0, 0, 0])
    tock()
    listEqual(CPU(0, 12345, 0), [0, 0, 12345, 1])
    tick()
    listEqual(CPU(0, 60432, 0), [12345, 0, 12345, 1])
    tock()
    listEqual(CPU(0, 60432, 0), [12345, 0, 12345, 2])
    tick()
    listEqual(CPU(0, 23456, 0), [65535, 0, 12345, 2])
    tock()
    listEqual(CPU(0, 23456, 0), [65535, 0, 23456, 3])
    tick()
    listEqual(CPU(0, 57808, 0), [11111, 0, 23456, 3])
    tock()
    listEqual(CPU(0, 57808, 0), [12345, 0, 23456, 4])
    tick()
    listEqual(CPU(0, 1000, 0), [54425, 0, 23456, 4])
    tock()
    listEqual(CPU(0, 1000, 0), [54425, 0, 1000, 5])
    tick()
    listEqual(CPU(0, 58120, 0), [11111, 1, 1000, 5])
    tock()
    listEqual(CPU(0, 58120, 0), [11111, 1, 1000, 6])
    tick()
    listEqual(CPU(0, 1001, 0), [54425, 0, 1000, 6])
    tock()
    listEqual(CPU(0, 1001, 0), [54425, 0, 1001, 7])
    tick()
    listEqual(CPU(0, 58264, 0), [11110, 1, 1001, 7])
    tock()
    listEqual(CPU(0, 58264, 0), [11109, 1, 1001, 8])
    tick()
    listEqual(CPU(0, 1000, 0), [54426, 0, 1001, 8])
    tock()
    listEqual(CPU(0, 1000, 0), [54426, 0, 1000, 9])
    tick()
    listEqual(CPU(11111, 62672, 0), [65535, 0, 1000, 9])
    tock()
    listEqual(CPU(11111, 62672, 0), [54424, 0, 1000, 10])
    tick()
    listEqual(CPU(11111, 14, 0), [1000, 0, 1000, 10])
    tock()
    listEqual(CPU(11111, 14, 0), [14, 0, 14, 11])
    tick()
    listEqual(CPU(11111, 58116, 0), [65535, 0, 14, 11])
    tock()
    listEqual(CPU(11111, 58116, 0), [65535, 0, 14, 14])
    tick()
    listEqual(CPU(11111, 999, 0), [1, 0, 14, 14])
    tock()
    listEqual(CPU(11111, 999, 0), [1, 0, 999, 15])
    tick()
    listEqual(CPU(11111, 60896, 0), [1000, 0, 999, 15])
    tock()
    listEqual(CPU(11111, 60896, 0), [1001, 0, 1000, 16])
    tick()
    listEqual(CPU(11111, 58120, 0), [65535, 1, 1000, 16])
    tock()
    listEqual(CPU(11111, 58120, 0), [65535, 1, 1000, 17])
    tick()
    listEqual(CPU(11111, 21, 0), [1000, 0, 1000, 17])
    tock()
    listEqual(CPU(11111, 21, 0), [21, 0, 21, 18])
    tick()
    listEqual(CPU(11111, 59330, 0), [0, 0, 21, 18])
    tock()
    listEqual(CPU(11111, 59330, 0), [0, 0, 21, 21])
    tick()
    listEqual(CPU(11111, 2, 0), [21, 0, 21, 21])
    tock()
    listEqual(CPU(11111, 2, 0), [2, 0, 2, 22])
    tick()
    listEqual(CPU(11111, 57488, 0), [1, 0, 2, 22])
    tock()
    listEqual(CPU(11111, 57488, 0), [3, 0, 2, 23])
    tick()
    listEqual(CPU(11111, 1000, 0), [65535, 0, 2, 23])
    tock()
    listEqual(CPU(11111, 1000, 0), [65535, 0, 1000, 24])
    tick()
    listEqual(CPU(11111, 61072, 0), [65535, 0, 1000, 24])
    tock()
    listEqual(CPU(11111, 61072, 0), [65535, 0, 1000, 25])
    tick()
    listEqual(CPU(11111, 58113, 0), [65535, 0, 1000, 25])
    tock()
    listEqual(CPU(11111, 58113, 0), [65535, 0, 1000, 26])
    tick()
    listEqual(CPU(11111, 58114, 0), [65535, 0, 1000, 26])
    tock()
    listEqual(CPU(11111, 58114, 0), [65535, 0, 1000, 27])
    tick()
    listEqual(CPU(11111, 58115, 0), [65535, 0, 1000, 27])
    tock()
    listEqual(CPU(11111, 58115, 0), [65535, 0, 1000, 28])
    tick()
    listEqual(CPU(11111, 58116, 0), [65535, 0, 1000, 28])
    tock()
    listEqual(CPU(11111, 58116, 0), [65535, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58117, 0), [65535, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58117, 0), [65535, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58118, 0), [65535, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58118, 0), [65535, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 0), [65535, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 0), [65535, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 60048, 0), [0, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 60048, 0), [0, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58113, 0), [0, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58113, 0), [0, 0, 1000, 1002])
    tick()
    listEqual(CPU(11111, 58114, 0), [0, 0, 1000, 1002])
    tock()
    listEqual(CPU(11111, 58114, 0), [0, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58115, 0), [0, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58115, 0), [0, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58116, 0), [0, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58116, 0), [0, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58117, 0), [0, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58117, 0), [0, 0, 1000, 1002])
    tick()
    listEqual(CPU(11111, 58118, 0), [0, 0, 1000, 1002])
    tock()
    listEqual(CPU(11111, 58118, 0), [0, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 0), [0, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 0), [0, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 61392, 0), [1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 61392, 0), [1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58113, 0), [1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58113, 0), [1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58114, 0), [1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58114, 0), [1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58115, 0), [1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58115, 0), [1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58116, 0), [1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58116, 0), [1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58117, 0), [1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58117, 0), [1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58118, 0), [1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58118, 0), [1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58119, 0), [1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58119, 0), [1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 1), [1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 1), [1, 0, 1000, 0])
    tick()
    listEqual(CPU(0, 12345, 0), [-1, 0, 1000, 0])
    tock()
    listEqual(CPU(0, 12345, 0), [-1, 0, 12345, 1])
    tick()
    listEqual(CPU(0, 60432, 0), [-1, 0, 12345, 1])
    tock()
    listEqual(CPU(0, 60432, 0), [-1, 0, 12345, 2])
    tick()
    listEqual(CPU(0, 23456, 0), [-1, 0, 12345, 2])
    tock()
    listEqual(CPU(0, 23456, 0), [-1, 0, 23456, 3])
    tick()
    listEqual(CPU(0, 57840, 0), [-1, 0, 23456, 3])
    tock()
    listEqual(CPU(0, 57840, 0), [-1, 0, 11111, 4])
    tick()
    listEqual(CPU(0, 1003, 0), [-1, 0, 11111, 4])
    tock()
    listEqual(CPU(0, 1003, 0), [-1, 0, 1003, 5])
    tick()
    listEqual(CPU(0, 58120, 0), [11111, 1, 1003, 5])
    tock()
    listEqual(CPU(0, 58120, 0), [11111, 1, 1003, 6])
    tick()
    listEqual(CPU(0, 1004, 0), [-1, 0, 1003, 6])
    tock()
    listEqual(CPU(0, 1004, 0), [-1, 0, 1004, 7])
    tick()
    listEqual(CPU(0, 58264, 0), [11110, 1, 1004, 7])
    tock()
    listEqual(CPU(0, 58264, 0), [11109, 1, 1004, 8])
    tick()
    listEqual(CPU(0, 1000, 0), [-1, 0, 1004, 8])
    tock()
    listEqual(CPU(0, 1000, 0), [-1, 0, 1000, 9])
    tick()
    listEqual(CPU(11111, 62704, 0), [-1, 0, 1000, 9])
    tock()
    listEqual(CPU(11111, 62704, 0), [-1, 0, 32767, 10])
    tick()
    listEqual(CPU(11111, 14, 0), [-1, 0, 32767, 10])
    tock()
    listEqual(CPU(11111, 14, 0), [-1, 0, 14, 11])
    tick()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 14, 11])
    tock()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 14, 14])
    tick()
    listEqual(CPU(11111, 999, 0), [-1, 0, 14, 14])
    tock()
    listEqual(CPU(11111, 999, 0), [-1, 0, 999, 15])
    tick()
    listEqual(CPU(11111, 64992, 0), [-1, 0, 999, 15])
    tock()
    listEqual(CPU(11111, 64992, 0), [-1, 0, 11112, 16])
    tick()
    listEqual(CPU(11111, 58152, 0), [65535, 1, 11112, 16])
    tock()
    listEqual(CPU(11111, 58152, 0), [65535, 1, 32767, 17])
    tick()
    listEqual(CPU(11111, 21, 0), [-1, 0, 32767, 17])
    tock()
    listEqual(CPU(11111, 21, 0), [-1, 0, 21, 18])
    tick()
    listEqual(CPU(11111, 59330, 0), [-1, 0, 21, 18])
    tock()
    listEqual(CPU(11111, 59330, 0), [-1, 0, 21, 21])
    tick()
    listEqual(CPU(11111, 2, 0), [-1, 0, 21, 21])
    tock()
    listEqual(CPU(11111, 2, 0), [-1, 0, 2, 22])
    tick()
    listEqual(CPU(11111, 57528, 0), [1, 1, 2, 22])
    tock()
    listEqual(CPU(11111, 57528, 0), [2, 1, 1, 23])
    tick()
    listEqual(CPU(11111, 64968, 0), [11112, 1, 1, 23])
    tock()
    listEqual(CPU(11111, 64968, 0), [11112, 1, 1, 24])
    tick()
    listEqual(CPU(11111, 64680, 0), [11110, 1, 1, 24])
    tock()
    listEqual(CPU(11111, 64680, 0), [11110, 1, 11110, 25])
    tick()
    listEqual(CPU(11111, 1000, 0), [-1, 0, 11110, 25])
    tock()
    listEqual(CPU(11111, 1000, 0), [-1, 0, 1000, 26])
    tick()
    listEqual(CPU(11111, 61072, 0), [-1, 0, 1000, 26])
    tock()
    listEqual(CPU(11111, 61072, 0), [-1, 0, 1000, 27])
    tick()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 27])
    tock()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 28])
    tick()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 28])
    tock()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 29])
    tick()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 29])
    tock()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 30])
    tick()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 30])
    tock()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 60048, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 60048, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 1002])
    tick()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 1002])
    tock()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1002])
    tick()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1002])
    tock()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 61392, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 61392, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58113, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58114, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58115, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58116, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58117, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58118, 0), [-1, 0, 1000, 1001])
    tick()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1001])
    tock()
    listEqual(CPU(11111, 58119, 0), [-1, 0, 1000, 1000])
    tick()
    listEqual(CPU(11111, 58119, 1), [-1, 0, 1000, 1000])
    tock()
    listEqual(CPU(11111, 58119, 1), [-1, 0, 1000, 0])
    tick()
    listEqual(CPU(11111, 32767, 0), [-1, 0, 1000, 0])
    tock()
    listEqual(CPU(11111, 32767, 0), [-1, 0, 32767, 1])
    console.log("CPU test cases passed");
}